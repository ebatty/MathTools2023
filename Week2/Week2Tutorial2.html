

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Tutorial 2 &#8212; Mathematical Tools for Neuroscientists</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Week2/Week2Tutorial2';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Week 3: Discrete Dynamics &amp; Eigenstuff" href="../Week3/Overview.html" />
    <link rel="prev" title="Tutorial 1" href="Week2Tutorial1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Mathematical Tools for Neuroscientists</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Algebra &amp; Dynamical Systems</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week1/Overview.html">Week 1: Vectors</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week1/KeyConcepts.html">Key concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1/Video11.html">Video 1.1: What is a vector?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1/Video12.html">Video 1.2: Vector properties &amp; operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1/Video13.html">Video 1.3: Linear combinations, span, and basis vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week1/Week1Tutorial1.html">Tutorial 1</a></li>






</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Overview.html">Week 2: Matrices</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="KeyConcepts.html">Key concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="Video21.html">Video 2.1: Linear transformations and matrices (3Blue1Brown)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Video22.html">Video 2.2: Matrix multiplication as composition(3Blue1Brown)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Video23.html">Video 2.3: The determinant (3Blue1Brown)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Video24.html">Video 2.4: Inverse matrices, column space, and null space (3Blue1Brown)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Video25.html">Video 2.5: Nonsquare matrices as transformations between dimensions (3Blue1Brown)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Week2Tutorial1.html">Tutorial 1</a></li>



<li class="toctree-l2 current active"><a class="current reference internal" href="#">Tutorial 2</a></li>


</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week3/Overview.html">Week 3: Discrete Dynamics &amp; Eigenstuff</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week3/KeyConcepts.html">Key concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week3/Video31.html">Video 3.1: Intro to Dynamical Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week3/Video32.html">Video 3.2: Discrete Dynamical Neural Circuit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week3/Video33.html">Video 3.3: Eigenvalues and eigenvectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week3/Week3Tutorial1.html">Tutorial 1</a></li>




<li class="toctree-l2"><a class="reference internal" href="../Week3/Week3Tutorial2.html">Tutorial 2</a></li>



</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week4/Overview.html">Week 4: Continuous Dynamical Systems &amp; Differential Equations</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week4/KeyConcepts.html">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week4/Video41.html">(Optional) Video 4.1: Review of Differentiation &amp; Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week4/Video42.html">Video 4.2: Solving differential equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week4/Video43.html">Video 4.3: Systems of differential equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week4/Week4Tutorial1.html">Tutorial 1</a></li>





<li class="toctree-l2"><a class="reference internal" href="../Week4/Week4Tutorial2.html">Tutorial 2</a></li>





</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week5/Overview.html">Week 5: Matrix Decomposition &amp; Dimensionality Reduction</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week5/KeyConcepts.html">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week5/Video51.html">Video 5.1: Special Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week5/Video52.html">Video 5.2: Matrix Decomposition &amp; SVD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week5/Video53.html">Video 5.3: PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week5/Week5Tutorial1.html">Tutorial 1</a></li>




</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../LinearAlgebraReview/Overview.html">Review</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../LinearAlgebraReview/MathTools_Homework1.html">Homework 1</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Probability &amp; Statistics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week6/Overview.html">Week 6: Intro to Probability</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week6/KeyConcepts.html">Key Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week6/Reading61.html">Reading 6.1: Intro to Probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week6/Week6Tutorial1.html">Tutorial 1</a></li>





</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week7/Overview.html">Week 7: Intro to Statistics</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week7/Video71.html">Video 7.1: Descriptive Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week7/Video72.html">Video 7.2: Overview of Statistical Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week7/Video73.html">Video 7.3: Point Estimators Examples &amp; Goodness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week7/Video74.html">Video 7.4: Maximum Likelihood Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week7/Video75.html">Video 7.5: Bayesian Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week7/Week7Tutorial1.html">Tutorial 1</a></li>



<li class="toctree-l2"><a class="reference internal" href="../Week7/Week7Tutorial2.html">Tutorial 2</a></li>


</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week8/Overview.html">Week 8: Statistical Encoding &amp; Decoding</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week8/Video81.html">Video 8.1: What are encoding &amp; decoding?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week8/Video82.html">Video 8.2: Statistical encoding models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week8/Week8Tutorial1.html">Tutorial 1</a></li>




<li class="toctree-l2"><a class="reference internal" href="../Week8/Week8Tutorial2.html">(Optional) Tutorial 2</a></li>


</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week9/Overview.html">Week 9: Linear Regression</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week9/Video91.html">Video 9.1: What is machine learning?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week9/Video92.html">Video 9.2: Types of machine learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week9/Video93.html">Video 9.3: Linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week9/Week9Tutorial1.html">Tutorial 1</a></li>



</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week10/Overview.html">Week 10: Model Selection</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week10/KeyConcepts.html">Key concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week10/Video101.html">Video 10.1: Model evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week10/Video102.html">Video 10.2: Bootstrapping (NMA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week10/Video103.html">Video 10.3: Model selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week10/Week10Tutorial1.html">Tutorial 1</a></li>




<li class="toctree-l2"><a class="reference internal" href="../Week10/Week10Tutorial2.html">Tutorial 2</a></li>





</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Week11/Overview.html">Week 11: Clustering</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Week11/Video111.html">Video 11.1: Clustering Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week11/Video112.html">Video 11.2: Types of Clustering Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Week11/Video113.html">Video 11.3: K-Means Clustering</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/ebatty/MathTools2023/blob/jupyterbook/Week2/Week2Tutorial2.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Week2/Week2Tutorial2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial 2</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Tutorial 2</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-functions">Plotting functions</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-don-t-be-a-square">Exercise 1: Don’t be a square</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-rank-range-if-n-m">A) Rank &amp; range if n &lt; m</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#b-rank-range-if-m-n">B) Rank &amp; range if m &lt; n</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-info-inverses-of-nonsquare-matrices">Extra info: Inverses of nonsquare matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-info-determinants-of-nonsquare-matrices">Extra info: Determinants of nonsquare matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-info-the-rank-theorem">Extra info: The Rank Theorem</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-exercise-2-changing-basis">(Optional) Exercise 2: Changing basis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-changing-to-the-standard-basis">A) Changing to the standard basis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#b-changing-from-the-standard-basis">B) Changing from the standard basis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#c-changing-basis-criterion">C) Changing basis criterion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-info-changing-between-two-non-standard-bases">Extra info: Changing between two non-standard bases</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p><a href="https://colab.research.google.com/github/ebatty/MathToolsforNeuroscience/blob/jupyterbook/Week2/Week2Tutorial2.ipynb" target="_parent"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="tutorial-2">
<h1>Tutorial 2<a class="headerlink" href="#tutorial-2" title="Permalink to this heading">#</a></h1>
<p><strong>Linear Algebra II, Matrices</strong></p>
<p><strong>[insert your name]</strong></p>
<p><strong>Important reminders</strong>: Before starting, click “File -&gt; Save a copy in Drive”. Produce a pdf for submission by “File -&gt; Print” and then choose “Save to PDF”.</p>
<p>To complete this tutorial, you should have watched Videos 2.1 through 2.5.</p>
<p><strong>Credits:</strong>
The videos you watched for this week were from 3Blue1Brown. Some elements of this problem set are from or inspired by https://openedx.seas.gwu.edu/courses/course-v1:GW+EngComp4+2019/about. In particular, we are using their <code class="docutils literal notranslate"><span class="pre">plot_linear_transformation</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_linear_transformations</span></code> functions, and the demonstration of the additional transformation of a matrix inverse (end of Exercise 2)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span>

<span class="c1"># Plotting parameters</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<section id="plotting-functions">
<h2>Plotting functions<a class="headerlink" href="#plotting-functions" title="Permalink to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Plotting functions</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">inv</span><span class="p">,</span> <span class="n">eig</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">ceil</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span><span class="p">,</span> <span class="n">ticker</span><span class="p">,</span> <span class="n">get_backend</span><span class="p">,</span> <span class="n">rc</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">cycle</span>

<span class="k">def</span> <span class="nf">plot_range_3_by_2_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="c1"># Make data</span>

    <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">a2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
          <span class="n">vec</span> <span class="o">=</span> <span class="n">a1</span><span class="o">*</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">a2</span><span class="o">*</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
          <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="n">vec</span>
          <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
          <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>
          <span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_null_2_by_3_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="c1"># Make data</span>

    <span class="n">basis</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">null_space</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">a2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>

          <span class="n">vec</span> <span class="o">=</span> <span class="n">a1</span><span class="o">*</span><span class="n">basis</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
          <span class="k">if</span> <span class="n">basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">vec</span> <span class="o">+=</span> <span class="n">a2</span><span class="o">*</span><span class="n">basis</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
          <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="n">vec</span>
          <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
          <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>
          <span class="n">z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>


<span class="n">_int_backends</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GTK3Agg&#39;</span><span class="p">,</span> <span class="s1">&#39;GTK3Cairo&#39;</span><span class="p">,</span> <span class="s1">&#39;MacOSX&#39;</span><span class="p">,</span> <span class="s1">&#39;nbAgg&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Qt4Agg&#39;</span><span class="p">,</span> <span class="s1">&#39;Qt4Cairo&#39;</span><span class="p">,</span> <span class="s1">&#39;Qt5Agg&#39;</span><span class="p">,</span> <span class="s1">&#39;Qt5Cairo&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TkAgg&#39;</span><span class="p">,</span> <span class="s1">&#39;TkCairo&#39;</span><span class="p">,</span> <span class="s1">&#39;WebAgg&#39;</span><span class="p">,</span> <span class="s1">&#39;WX&#39;</span><span class="p">,</span> <span class="s1">&#39;WXAgg&#39;</span><span class="p">,</span> <span class="s1">&#39;WXCairo&#39;</span><span class="p">]</span>
<span class="n">_backend</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span>   <span class="c1"># get current backend name</span>

<span class="c1"># shrink figsize and fontsize when using %matplotlib notebook</span>
<span class="k">if</span> <span class="n">_backend</span> <span class="ow">in</span> <span class="n">_int_backends</span><span class="p">:</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">fig_scale</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">fig_scale</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">grey</span> <span class="o">=</span> <span class="s1">&#39;#808080&#39;</span>
<span class="n">gold</span> <span class="o">=</span> <span class="s1">&#39;#cab18c&#39;</span>   <span class="c1"># x-axis grid</span>
<span class="n">lightblue</span> <span class="o">=</span> <span class="s1">&#39;#0096d6&#39;</span>  <span class="c1"># y-axis grid</span>
<span class="n">green</span> <span class="o">=</span> <span class="s1">&#39;#008367&#39;</span>  <span class="c1"># x-axis basis vector</span>
<span class="n">red</span> <span class="o">=</span> <span class="s1">&#39;#E31937&#39;</span>    <span class="c1"># y-axis basis vector</span>
<span class="n">darkblue</span> <span class="o">=</span> <span class="s1">&#39;#004065&#39;</span>

<span class="n">pink</span><span class="p">,</span> <span class="n">yellow</span><span class="p">,</span> <span class="n">orange</span><span class="p">,</span> <span class="n">purple</span><span class="p">,</span> <span class="n">brown</span> <span class="o">=</span> <span class="s1">&#39;#ef7b9d&#39;</span><span class="p">,</span> <span class="s1">&#39;#fbd349&#39;</span><span class="p">,</span> <span class="s1">&#39;#ffa500&#39;</span><span class="p">,</span> <span class="s1">&#39;#a35cff&#39;</span><span class="p">,</span> <span class="s1">&#39;#731d1d&#39;</span>

<span class="n">quiver_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;angles&#39;</span><span class="p">:</span> <span class="s1">&#39;xy&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;scale_units&#39;</span><span class="p">:</span> <span class="s1">&#39;xy&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">0.012</span><span class="p">}</span>

<span class="n">grid_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
               <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">set_rc</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
        <span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
        <span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">axisbelow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">rc</span><span class="p">(</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wrapper</span>

<span class="nd">@set_rc</span>
<span class="k">def</span> <span class="nf">plot_vector</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="n">tails</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Draw 2d vectors based on the values of the vectors and the position of their tails.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    vectors : list.</span>
<span class="sd">        List of 2-element array-like structures, each represents a 2d vector.</span>
<span class="sd">    </span>
<span class="sd">    tails : list, optional.</span>
<span class="sd">        List of 2-element array-like structures, each represents the coordinates of the tail</span>
<span class="sd">        of the corresponding vector in vectors. If None (default), all tails are set at the</span>
<span class="sd">        origin (0,0). If len(tails) is 1, all tails are set at the same position. Otherwise,</span>
<span class="sd">        vectors and tails must have the same length.</span>
<span class="sd">    </span>
<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; v = [(1, 3), (3, 3), (4, 6)]</span>
<span class="sd">    &gt;&gt;&gt; plot_vector(v)      # draw 3 vectors with their tails at origin</span>
<span class="sd">    &gt;&gt;&gt; t = [numpy.array((2, 2))]</span>
<span class="sd">    &gt;&gt;&gt; plot_vector(v, t)   # draw 3 vectors with their tails at (2,2)</span>
<span class="sd">    &gt;&gt;&gt; t = [[3, 2], [-1, -2], [3, 5]]</span>
<span class="sd">    &gt;&gt;&gt; plot_vector(v, t)   # draw 3 vectors with 3 different tails</span>

<span class="sd">    &#39;&#39;&#39;</span>   
    <span class="n">vectors</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">vectors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Each vector should have 2 elements.&quot;</span>  
    <span class="k">if</span> <span class="n">tails</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tails</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tails</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">tails</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Each tail should have 2 elements.&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tails</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
    
    <span class="c1"># tile vectors or tails array if needed</span>
    <span class="n">nvectors</span> <span class="o">=</span> <span class="n">vectors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ntails</span> <span class="o">=</span> <span class="n">tails</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">nvectors</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ntails</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">vectors</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="p">(</span><span class="n">ntails</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">ntails</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">nvectors</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">tails</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">tails</span><span class="p">,</span> <span class="p">(</span><span class="n">nvectors</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">tails</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">vectors</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;vectors and tail must have a same shape&quot;</span>

    <span class="c1"># calculate xlimit &amp; ylimit</span>
    <span class="n">heads</span> <span class="o">=</span> <span class="n">tails</span> <span class="o">+</span> <span class="n">vectors</span>
    <span class="n">limit</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">tails</span><span class="p">,</span> <span class="n">heads</span><span class="p">))))</span>
    <span class="n">limit</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">)</span>   <span class="c1"># add some margins</span>
    
    <span class="n">figsize</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">fig_scale</span>
    <span class="n">figure</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">tails</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">tails</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">vectors</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">vectors</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">darkblue</span><span class="p">,</span> 
                  <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="n">limit</span><span class="p">,</span> <span class="n">limit</span><span class="p">])</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="n">limit</span><span class="p">,</span> <span class="n">limit</span><span class="p">])</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># if xticks and yticks of grid do not match, choose the finer one</span>
    <span class="n">xticks</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">()</span>
    <span class="n">yticks</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">xticks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xticks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">yticks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">yticks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">base</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># grid interval is always an integer</span>
    <span class="n">loc</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="n">base</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">grid_params</span><span class="p">)</span>
    
    <span class="c1"># show x-y axis in the center, hide frames</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="nd">@set_rc</span>
<span class="k">def</span> <span class="nf">plot_transformation_helper</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="o">*</span><span class="n">vectors</span><span class="p">,</span> <span class="n">unit_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unit_circle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; A helper function to plot the linear transformation defined by a 2x2 matrix.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    axis : class matplotlib.axes.Axes.</span>
<span class="sd">        The axes to plot on.</span>

<span class="sd">    matrix : class numpy.ndarray.</span>
<span class="sd">        The 2x2 matrix to visualize.</span>

<span class="sd">    *vectors : class numpy.ndarray.</span>
<span class="sd">        The vector(s) to plot along with the linear transformation. Each array denotes a vector&#39;s</span>
<span class="sd">        coordinates before the transformation and must have a shape of (2,). Accept any number of vectors. </span>
<span class="sd">    </span>
<span class="sd">    unit_vector : bool, optional.</span>
<span class="sd">        Whether to plot unit vectors of the standard basis, default to True.</span>
<span class="sd">    </span>
<span class="sd">    unit_circle: bool, optional.</span>
<span class="sd">        Whether to plot unit circle, default to False.</span>
<span class="sd">    </span>
<span class="sd">    title: str, optional.</span>
<span class="sd">        Title of the plot.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;the input matrix must have a shape of (2,2)&quot;</span>
    <span class="n">grid_range</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">grid_range</span><span class="p">,</span> <span class="n">grid_range</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">X_</span><span class="p">,</span> <span class="n">Y_</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">X_</span> <span class="o">+</span> <span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Y_</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">X_</span> <span class="o">+</span> <span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Y_</span>
    <span class="n">origin</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        
    <span class="c1"># draw grid lines</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">Y</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">c</span><span class="o">=</span><span class="n">gold</span><span class="p">,</span> <span class="o">**</span><span class="n">grid_params</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">Y</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">lightblue</span><span class="p">,</span> <span class="o">**</span><span class="n">grid_params</span><span class="p">)</span>
    
    <span class="c1"># draw (transformed) unit vectors</span>
    <span class="k">if</span> <span class="n">unit_vector</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="p">[</span><span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">I</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">green</span><span class="p">,</span> <span class="o">**</span><span class="n">quiver_params</span><span class="p">)</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="p">[</span><span class="n">J</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">J</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">red</span><span class="p">,</span> <span class="o">**</span><span class="n">quiver_params</span><span class="p">)</span>

    <span class="c1"># draw optional vectors</span>
    <span class="n">color_cycle</span> <span class="o">=</span> <span class="n">cycle</span><span class="p">([</span><span class="n">pink</span><span class="p">,</span> <span class="n">darkblue</span><span class="p">,</span> <span class="n">orange</span><span class="p">,</span> <span class="n">purple</span><span class="p">,</span> <span class="n">brown</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">vectors</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">vector</span> <span class="ow">in</span> <span class="n">vectors</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">color_cycle</span><span class="p">)</span>
            <span class="n">vector_</span> <span class="o">=</span> <span class="n">matrix</span> <span class="o">@</span> <span class="n">vector</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">origin</span><span class="p">,</span> <span class="p">[</span><span class="n">vector_</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">vector_</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">quiver_params</span><span class="p">)</span>

    <span class="c1"># draw optional unit circle</span>
    <span class="k">if</span> <span class="n">unit_circle</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span>  <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">41</span><span class="p">)</span>
        <span class="n">circle</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)))</span>
        <span class="n">circle_trans</span> <span class="o">=</span> <span class="n">matrix</span> <span class="o">@</span> <span class="n">circle</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">circle_trans</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">circle_trans</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">red</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="c1"># hide frames, set xlimit &amp; ylimit, set title</span>
    <span class="n">limit</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="n">limit</span><span class="p">,</span> <span class="n">limit</span><span class="p">])</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="n">limit</span><span class="p">,</span> <span class="n">limit</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

<span class="nd">@set_rc</span>
<span class="k">def</span> <span class="nf">plot_linear_transformation</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="o">*</span><span class="n">vectors</span><span class="p">,</span> <span class="n">unit_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unit_circle</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Plot the linear transformation defined by a 2x2 matrix using the helper</span>
<span class="sd">    function plot_transformation_helper(). It will create 2 subplots to visualize some</span>
<span class="sd">    vectors before and after the transformation.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    matrix : class numpy.ndarray.</span>
<span class="sd">        The 2x2 matrix to visualize.</span>

<span class="sd">    *vectors : class numpy.ndarray.</span>
<span class="sd">        The vector(s) to plot along with the linear transformation. Each array denotes a vector&#39;s</span>
<span class="sd">        coordinates before the transformation and must have a shape of (2,). Accept any number of vectors.</span>
<span class="sd">    </span>
<span class="sd">    unit_vector : bool, optional.</span>
<span class="sd">        Whether to plot unit vectors of the standard basis, default to True.</span>
<span class="sd">    </span>
<span class="sd">    unit_circle: bool, optional.</span>
<span class="sd">        Whether to plot unit circle, default to False.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">figsize</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="n">fig_scale</span>
    <span class="n">figure</span><span class="p">,</span> <span class="p">(</span><span class="n">axis1</span><span class="p">,</span> <span class="n">axis2</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">plot_transformation_helper</span><span class="p">(</span><span class="n">axis1</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">*</span><span class="n">vectors</span><span class="p">,</span> <span class="n">unit_vector</span><span class="o">=</span><span class="n">unit_vector</span><span class="p">,</span> <span class="n">unit_circle</span><span class="o">=</span><span class="n">unit_circle</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Before transformation&#39;</span><span class="p">)</span>
    <span class="n">plot_transformation_helper</span><span class="p">(</span><span class="n">axis2</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="o">*</span><span class="n">vectors</span><span class="p">,</span> <span class="n">unit_vector</span><span class="o">=</span><span class="n">unit_vector</span><span class="p">,</span> <span class="n">unit_circle</span><span class="o">=</span><span class="n">unit_circle</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;After transformation&#39;</span><span class="p">)</span>

<span class="nd">@set_rc</span>
<span class="k">def</span> <span class="nf">plot_linear_transformations</span><span class="p">(</span><span class="o">*</span><span class="n">matrices</span><span class="p">,</span> <span class="n">unit_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unit_circle</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Plot the linear transformation defined by a sequence of n 2x2 matrices using the helper</span>
<span class="sd">    function plot_transformation_helper(). It will create n+1 subplots to visualize some</span>
<span class="sd">    vectors before and after each transformation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    *matrices : class numpy.ndarray.</span>
<span class="sd">        The 2x2 matrices to visualize. Accept any number of matrices.</span>
<span class="sd">    </span>
<span class="sd">    unit_vector : bool, optional.</span>
<span class="sd">        Whether to plot unit vectors of the standard basis, default to True.</span>
<span class="sd">    </span>
<span class="sd">    unit_circle: bool, optional.</span>
<span class="sd">        Whether to plot unit circle, default to False.</span>
<span class="sd">      </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nplots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrices</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">nplots</span><span class="o">/</span><span class="n">nx</span><span class="p">)</span>
    <span class="n">figsize</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">nx</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">ny</span><span class="p">])</span> <span class="o">*</span> <span class="n">fig_scale</span>
    <span class="n">figure</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nplots</span><span class="p">):</span>  <span class="c1"># fig_idx </span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">matrix_trans</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Before transformation&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">matrix_trans</span> <span class="o">=</span> <span class="n">matrices</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">matrix_trans</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;After </span><span class="si">{}</span><span class="s1"> transformation&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;After </span><span class="si">{}</span><span class="s1"> transformations&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">plot_transformation_helper</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="n">nx</span><span class="p">,</span> <span class="n">i</span><span class="o">%</span><span class="k">nx</span>], matrix_trans, unit_vector=unit_vector, unit_circle=unit_circle, title=title)
    <span class="c1"># hide axes of the extra subplot (only when nplots is an odd number)</span>
    <span class="k">if</span> <span class="n">nx</span><span class="o">*</span><span class="n">ny</span> <span class="o">&gt;</span> <span class="n">nplots</span><span class="p">:</span>
        <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="exercise-1-don-t-be-a-square">
<h1>Exercise 1: Don’t be a square<a class="headerlink" href="#exercise-1-don-t-be-a-square" title="Permalink to this heading">#</a></h1>
<p>In linear algebra, square matrices get a lot of the attention. We will often be dealing with m x n non-square matrices though, especially in neuroscience contexts! In this problem set, we’ll explore nonsquare matrices a bit more.</p>
<section id="a-rank-range-if-n-m">
<h2>A) Rank &amp; range if n &lt; m<a class="headerlink" href="#a-rank-range-if-n-m" title="Permalink to this heading">#</a></h2>
<p>i) If we have a 4 x 2 matrix A, what is the maximum possible rank of this matrix? (Hint: think about the columns of A)</p>
<p>ii) What does this mean for the range of the associated linear transformation? What is the maximum dimensionality subspace is can be?</p>
<p>iii) If we have an m x n matrix where n &lt; m, can we ever reach every vector in <span class="math notranslate nohighlight">\(R^m\)</span>?</p>
<p><strong>Your text answer</strong></p>
<p>Play around below with inputting a 3 x 2 matrix and seeing the resulting range/column space in <span class="math notranslate nohighlight">\(R^3\)</span>. In this plot, we’re taking all vectors with elements between -10 and 10 in <span class="math notranslate nohighlight">\(R^2\)</span> and plotting the transformed vector in <span class="math notranslate nohighlight">\(R^3\)</span>.</p>
<p>First test a random matrix. Then create a matrix that results in a 1D line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matrix</span> <span class="o">=</span> <span class="o">...</span>

<span class="n">plot_range_3_by_2_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">matrix</span> <span class="o">=</span> <span class="o">...</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">plot_range_3_by_2_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

<span class="nn">Cell In[2], line 20,</span> in <span class="ni">plot_range_3_by_2_matrix</span><span class="nt">(matrix)</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="k">for</span> <span class="n">a1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span>   <span class="k">for</span> <span class="n">a2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">20</span>       <span class="n">vec</span> <span class="o">=</span> <span class="n">a1</span><span class="o">*</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">a2</span><span class="o">*</span><span class="n">matrix</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span>       <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="n">vec</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span>       <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>

<span class="ne">TypeError</span>: &#39;ellipsis&#39; object is not subscriptable
</pre></div>
</div>
<img alt="../_images/ece9f6430691b517340c5e02f2d8fd390dfa19d840a3816906b0f9a6f5bb8002.png" src="../_images/ece9f6430691b517340c5e02f2d8fd390dfa19d840a3816906b0f9a6f5bb8002.png" />
</div>
</div>
</section>
<section id="b-rank-range-if-m-n">
<h2>B) Rank &amp; range if m &lt; n<a class="headerlink" href="#b-rank-range-if-m-n" title="Permalink to this heading">#</a></h2>
<p>i) If we have a 2 x 4 matrix A, what is the maximum possible rank of this matrix?</p>
<p>ii) What is the minimum possible dimension of the null space for this matrix? (Hint: think about how space squishes)</p>
<p><strong>Your text answer</strong></p>
<p>Below, we’ll visualize the null space of a 2 x 3 matrix. Try out a random matrix and see what happens! Can you figure out how to make the null space 2D (Hint: take a look at Extra info: The Rank Theorem)?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">matrix</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">plot_null_2_by_3_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">matrix</span> <span class="o">=</span> <span class="o">...</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">plot_null_2_by_3_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

<span class="nn">Cell In[2], line 34,</span> in <span class="ni">plot_null_2_by_3_matrix</span><span class="nt">(matrix)</span>
<span class="g g-Whitespace">     </span><span class="mi">31</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span> <span class="c1"># Make data</span>
<span class="ne">---&gt; </span><span class="mi">34</span> <span class="n">basis</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">null_space</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">35</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">     </span><span class="mi">36</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/scipy/linalg/_decomp_svd.py:389,</span> in <span class="ni">null_space</span><span class="nt">(A, rcond)</span>
<span class="g g-Whitespace">    </span><span class="mi">335</span> <span class="k">def</span> <span class="nf">null_space</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">336</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">337</span><span class="sd">     Construct an orthonormal basis for the null space of A using SVD</span>
<span class="g g-Whitespace">    </span><span class="mi">338</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">387</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">388</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">389</span>     <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vh</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">390</span>     <span class="n">M</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vh</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">391</span>     <span class="k">if</span> <span class="n">rcond</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/scipy/linalg/_decomp_svd.py:108,</span> in <span class="ni">svd</span><span class="nt">(a, full_matrices, compute_uv, overwrite_a, check_finite, lapack_driver)</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="k">def</span> <span class="nf">svd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span>         <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lapack_driver</span><span class="o">=</span><span class="s1">&#39;gesdd&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span><span class="sd">     Singular Value Decomposition.</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">106</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">107</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">108</span>     <span class="n">a1</span> <span class="o">=</span> <span class="n">_asarray_validated</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span>     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">110</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected matrix&#39;</span><span class="p">)</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/scipy/_lib/_util.py:255,</span> in <span class="ni">_asarray_validated</span><span class="nt">(a, check_finite, sparse_ok, objects_ok, mask_ok, as_inexact)</span>
<span class="g g-Whitespace">    </span><span class="mi">253</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">objects_ok</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">254</span>     <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">255</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;object arrays are not supported&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">256</span> <span class="k">if</span> <span class="n">as_inexact</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">257</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inexact</span><span class="p">):</span>

<span class="ne">ValueError</span>: object arrays are not supported
</pre></div>
</div>
<img alt="../_images/ece9f6430691b517340c5e02f2d8fd390dfa19d840a3816906b0f9a6f5bb8002.png" src="../_images/ece9f6430691b517340c5e02f2d8fd390dfa19d840a3816906b0f9a6f5bb8002.png" />
</div>
</div>
</section>
<section id="extra-info-inverses-of-nonsquare-matrices">
<h2>Extra info: Inverses of nonsquare matrices<a class="headerlink" href="#extra-info-inverses-of-nonsquare-matrices" title="Permalink to this heading">#</a></h2>
<p>Nonsquare matrices do not have inverses. By definition, for matrix A, an inverse of A exists only if <span class="math notranslate nohighlight">\(A^{-1}A = AA^{-1} = I_n\)</span>. If you have a nonsquare matrix A, you can never get the dimensions of <span class="math notranslate nohighlight">\(A^{-1}\)</span> to work.</p>
<p>Left and right inverses of nonsquare matrices do exist. If <span class="math notranslate nohighlight">\(A\)</span> is m x n and has rank equal to n, <span class="math notranslate nohighlight">\(A\)</span> has a left inverse <span class="math notranslate nohighlight">\(B\)</span> such that <span class="math notranslate nohighlight">\(BA = I_n\)</span>, where <span class="math notranslate nohighlight">\(B\)</span> is n x m. If <span class="math notranslate nohighlight">\(A\)</span> has rank m, then is has a right inverse <span class="math notranslate nohighlight">\(C\)</span> such that <span class="math notranslate nohighlight">\(AC = I_m\)</span>, where C is n x m.</p>
<p>Thinking through why the rank conditions in this definition are what they are is difficult but will help consolidate your knowledge if you want to try! Think about going from larger to smaller spaces vs smaller to larger spaces</p>
</section>
<section id="extra-info-determinants-of-nonsquare-matrices">
<h2>Extra info: Determinants of nonsquare matrices<a class="headerlink" href="#extra-info-determinants-of-nonsquare-matrices" title="Permalink to this heading">#</a></h2>
<p>Nonsquare matrices do not have determinants. Intuitively, determinants denote how much the associated linear transformation changes the area or volume of space covered. Because nonsquare matrices are transforming between dimensions, you cannot really compute the area changes since it changes dimensions (how do you compute the difference between an area and a volume).</p>
</section>
<section id="extra-info-the-rank-theorem">
<h2>Extra info: The Rank Theorem<a class="headerlink" href="#extra-info-the-rank-theorem" title="Permalink to this heading">#</a></h2>
<p>There is a theorem that says for an m x n matrix <span class="math notranslate nohighlight">\(A\)</span>:</p>
<div class="math notranslate nohighlight">
\[rank A + dim Nul A = n\]</div>
<p>Basically the rank of a matrix plus the dimensionality of the null space must add up to the number of columns. We will see why this is true next week once we learn briefly how to solve matrix-vector equations by hand.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="optional-exercise-2-changing-basis">
<h1>(Optional) Exercise 2: Changing basis<a class="headerlink" href="#optional-exercise-2-changing-basis" title="Permalink to this heading">#</a></h1>
<p>In Video 1.3: Vector Spaces, we talked about changing basis (or changing coordinate systems). We looked at transforming a vector from a basis <span class="math notranslate nohighlight">\(\beta = \{\bar{b}_1, \bar{b}_2\}\)</span> where <span class="math notranslate nohighlight">\(\bar{b}_1 = \begin{bmatrix}
1 \\
1 \\
\end{bmatrix}\)</span> and <span class="math notranslate nohighlight">\(\bar{b}_2 = \begin{bmatrix}
-1 \\
1 \\
\end{bmatrix}\)</span> to the standard basis. In particular, we had the <span class="math notranslate nohighlight">\(\beta\)</span> coordinates of vector <span class="math notranslate nohighlight">\(\bar{a}\)</span> (coordinates of a vector with respect to basis <span class="math notranslate nohighlight">\(\beta\)</span>) as <span class="math notranslate nohighlight">\([\bar{a}]_{\beta} = \begin{bmatrix} 2 \\ 1 \\ \end{bmatrix}\)</span>.  We computed the standard coordinates as:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align} \bar{a} &amp;= 2 \bar{b}_1 + \bar{b}_2 \\
&amp;= \begin{bmatrix}
1 \\
3\\
\end{bmatrix}
 \end{align}\end{split}\]</div>
<section id="a-changing-to-the-standard-basis">
<h2>A) Changing to the standard basis<a class="headerlink" href="#a-changing-to-the-standard-basis" title="Permalink to this heading">#</a></h2>
<p>Now that we have learned about matrix multiplication, we can figure out how to change basis using it!  We want to write a matrix P so that:</p>
<div class="math notranslate nohighlight">
\[ \bar{x} = P_{\beta}[\bar{x}]_{\beta}\]</div>
<p>In other words, a matrix that transforms from the vector in coordinates relative to <span class="math notranslate nohighlight">\(\beta\)</span> to one with the coordinates relative to the standard basis. <span class="math notranslate nohighlight">\(P_{\beta}\)</span> is called the change-of-coordinates matrix from <span class="math notranslate nohighlight">\(\beta\)</span> to the standard basis.</p>
<p>What is <span class="math notranslate nohighlight">\(P_{\beta}\)</span> for the basis given above?</p>
<p>Hints:
For the specific vector example,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
1 \\
3\\
\end{bmatrix} = P_{\beta}\begin{bmatrix}
2 \\
1\\
\end{bmatrix} \end{split}\]</div>
<p>You could find it by looking at the computation we did above and thinking how that could have been accomplished by a matrix multiplication or by thinking about what we learned this week: that matrices represent linear transformations and each column corresponds to where the corresponding basis vector ends up after the transformation.</p>
<p><strong>Your math answer</strong></p>
<p>Fill in <span class="math notranslate nohighlight">\(P_{\beta}\)</span> below and plot the resulting linear transformation. This visualization highlights something essential: when we are in the basis <span class="math notranslate nohighlight">\(\beta\)</span>  the <span class="math notranslate nohighlight">\(\beta\)</span> basis vectors seem like standard basis vectors. The Before transformation is when we are in “<span class="math notranslate nohighlight">\(\beta-land\)</span>” - it looks like when we are in standard basis vector land. It is only after we transform to standard coordinates, that we see the <span class="math notranslate nohighlight">\(\beta\)</span> vectors defined with respect to them (After transformation).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_beta</span> <span class="o">=</span> <span class="o">...</span>

<span class="n">plot_linear_transformation</span><span class="p">(</span><span class="n">p_beta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">p_beta</span> <span class="o">=</span> <span class="o">...</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">plot_linear_transformation</span><span class="p">(</span><span class="n">p_beta</span><span class="p">)</span>

<span class="nn">Cell In[2], line 88,</span> in <span class="ni">set_rc.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">86</span> <span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">axisbelow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span> <span class="n">rc</span><span class="p">(</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">88</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">Cell In[2], line 263,</span> in <span class="ni">plot_linear_transformation</span><span class="nt">(matrix, unit_vector, unit_circle, *vectors)</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span> <span class="n">figure</span><span class="p">,</span> <span class="p">(</span><span class="n">axis1</span><span class="p">,</span> <span class="n">axis2</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">262</span> <span class="n">plot_transformation_helper</span><span class="p">(</span><span class="n">axis1</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">*</span><span class="n">vectors</span><span class="p">,</span> <span class="n">unit_vector</span><span class="o">=</span><span class="n">unit_vector</span><span class="p">,</span> <span class="n">unit_circle</span><span class="o">=</span><span class="n">unit_circle</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Before transformation&#39;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">263</span> <span class="n">plot_transformation_helper</span><span class="p">(</span><span class="n">axis2</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="o">*</span><span class="n">vectors</span><span class="p">,</span> <span class="n">unit_vector</span><span class="o">=</span><span class="n">unit_vector</span><span class="p">,</span> <span class="n">unit_circle</span><span class="o">=</span><span class="n">unit_circle</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;After transformation&#39;</span><span class="p">)</span>

<span class="nn">Cell In[2], line 88,</span> in <span class="ni">set_rc.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">86</span> <span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">axisbelow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span> <span class="n">rc</span><span class="p">(</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">88</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">Cell In[2], line 190,</span> in <span class="ni">plot_transformation_helper</span><span class="nt">(axis, matrix, unit_vector, unit_circle, title, *vectors)</span>
<span class="g g-Whitespace">    </span><span class="mi">164</span> <span class="nd">@set_rc</span>
<span class="g g-Whitespace">    </span><span class="mi">165</span> <span class="k">def</span> <span class="nf">plot_transformation_helper</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="o">*</span><span class="n">vectors</span><span class="p">,</span> <span class="n">unit_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unit_circle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span><span class="w">     </span><span class="sd">&quot;&quot;&quot; A helper function to plot the linear transformation defined by a 2x2 matrix.</span>
<span class="g g-Whitespace">    </span><span class="mi">167</span><span class="sd">     </span>
<span class="g g-Whitespace">    </span><span class="mi">168</span><span class="sd">     Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">188</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">189</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">190</span>     <span class="k">assert</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;the input matrix must have a shape of (2,2)&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">191</span>     <span class="n">grid_range</span> <span class="o">=</span> <span class="mi">20</span>
<span class="g g-Whitespace">    </span><span class="mi">192</span>     <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">grid_range</span><span class="p">,</span> <span class="n">grid_range</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="ne">AttributeError</span>: &#39;ellipsis&#39; object has no attribute &#39;shape&#39;
</pre></div>
</div>
<img alt="../_images/63f140e01e95802e0298c5988ce4edc54775a828c49954e2612ae8926a9eaa78.png" src="../_images/63f140e01e95802e0298c5988ce4edc54775a828c49954e2612ae8926a9eaa78.png" />
</div>
</div>
</section>
<section id="b-changing-from-the-standard-basis">
<h2>B) Changing from the standard basis<a class="headerlink" href="#b-changing-from-the-standard-basis" title="Permalink to this heading">#</a></h2>
<p>Luckily for us, the matrix <span class="math notranslate nohighlight">\(P_{\beta}\)</span> is always invertible. We know this from the Invertible Matrix Theorem presented in Part 1 because the columns of <span class="math notranslate nohighlight">\(P_{\beta}\)</span> span <span class="math notranslate nohighlight">\(R^n\)</span> (since they are a basis for <span class="math notranslate nohighlight">\(R^n\)</span>). So we can compute the coordinates of a vector with respect to <span class="math notranslate nohighlight">\(\beta\)</span> as:</p>
<div class="math notranslate nohighlight">
\[ [\bar{x}]_{\beta} = P^{-1}_{\beta}\bar{x}\]</div>
<p>We will compute <span class="math notranslate nohighlight">\(P^{-1}_{\beta}\)</span> using code and find the <span class="math notranslate nohighlight">\(\beta\)</span> coordinates of <span class="math notranslate nohighlight">\(\bar{x} = \begin{bmatrix}
4 \\
2\\
\end{bmatrix}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_beta_inverse</span> <span class="o">=</span> <span class="o">...</span>

<span class="n">beta_coordinates</span> <span class="o">=</span> <span class="o">...</span>

<span class="nb">print</span><span class="p">(</span><span class="n">beta_coordinates</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ellipsis
</pre></div>
</div>
</div>
</div>
</section>
<section id="c-changing-basis-criterion">
<h2>C) Changing basis criterion<a class="headerlink" href="#c-changing-basis-criterion" title="Permalink to this heading">#</a></h2>
<p>Not every matrix-vector multiplication can be considered a change of basis. What has to be true of the matrix for it to be a change of basis?</p>
<p><strong>Your text answer</strong></p>
</section>
<section id="extra-info-changing-between-two-non-standard-bases">
<h2>Extra info: Changing between two non-standard bases<a class="headerlink" href="#extra-info-changing-between-two-non-standard-bases" title="Permalink to this heading">#</a></h2>
<p>We can also change from basis <span class="math notranslate nohighlight">\(\beta\)</span> to another basis <span class="math notranslate nohighlight">\(C\)</span> without first moving to the standard basis. We will not get into this here due to time constraints but you should have all the tools to understand the explanation here if you wish: https://math.berkeley.edu/~arash/54/notes/04_07.pdf</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ebatty/MathTools2023",
            ref: "jupyterbook",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Week2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Week2Tutorial1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial 1</p>
      </div>
    </a>
    <a class="right-next"
       href="../Week3/Overview.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 3: Discrete Dynamics &amp; Eigenstuff</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Tutorial 2</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-functions">Plotting functions</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1-don-t-be-a-square">Exercise 1: Don’t be a square</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-rank-range-if-n-m">A) Rank &amp; range if n &lt; m</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#b-rank-range-if-m-n">B) Rank &amp; range if m &lt; n</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-info-inverses-of-nonsquare-matrices">Extra info: Inverses of nonsquare matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-info-determinants-of-nonsquare-matrices">Extra info: Determinants of nonsquare matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-info-the-rank-theorem">Extra info: The Rank Theorem</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-exercise-2-changing-basis">(Optional) Exercise 2: Changing basis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-changing-to-the-standard-basis">A) Changing to the standard basis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#b-changing-from-the-standard-basis">B) Changing from the standard basis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#c-changing-basis-criterion">C) Changing basis criterion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-info-changing-between-two-non-standard-bases">Extra info: Changing between two non-standard bases</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ella Batty
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>